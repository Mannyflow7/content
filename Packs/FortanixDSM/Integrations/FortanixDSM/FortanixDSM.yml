category: Authentication
commonfields:
  id: Fortanix DSM
  version: -1
configuration:
- defaultvalue: https://sdkms.fortanix.com
  display: Fortanix DSM server endpoint (e.g., https://amer.smartkey.io)
  name: server
  required: true
  type: 0
- display: Username / App UUID / Certificate
  displaypassword: Password / App Secret / Private Key
  name: credentials
  required: false
  type: 9
- display: API Key
  name: token
  required: false
  type: 4
- defaultvalue: "true"
  display: Trust any server certificate (insecure)
  name: tls_enforce
  required: false
  type: 8
- defaultvalue: "false"
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
- display: Group UUID to list secrets from (optional)
  name: group_ids
  required: false
  type: 0
- additionalinfo: Also configure the Mode
  display: Data protection key used for encryption and decryption
  name: protection_key
  required: false
  type: 0
- display: Encryption and decryption mode
  name: protection_mode
  options:
  - FPE
  - GCM
  - CBC
  - None
  required: false
  type: 15
description: Manage Secrets and Protect Confidential Data using Fortanix Data Security Manager
display: Fortanix DSM
name: Fortanix DSM
script:
  commands:
  - arguments: []
    description: Test the Fortanix DSM integration server connection
    name: fortanix-test
    outputs:
    - contextPath: Fortanix.DSM.version
      description: Server version
    - contextPath: Fortanix.DSM.api_version
      description: API  version
    - contextPath: Fortanix.DSM.mode
      description: Server mode
  - arguments:
    - description: Group UUID to list secrets from (optional, overrides integration settings)
      name: group_id
    - auto: PREDEFINED
      description: Current state of the secret (optional, default show all except deleted or destroyed)
      name: state
      predefined:
      - enabled
      - disabled
      - preactive
      - active
      - deactivated
      - compromised
      - deleted
      - destroyed
    - description: Page offset to return (optional, 100 results at a time)
      name: page
    description: List secrets from one or more specified group(s)
    name: fortanix-list-secrets
    outputs:
    - contextPath: Fortanix.Secret.Name
      description: Secret Name
      type: string
    - contextPath: Fortanix.Secret.ID
      description: Secret ID (Key ID or kid)
      type: string
    - contextPath: Fortanix.Secret.Group
      description: Group ID
  - arguments:
    - description: Name of the secret (mandatory, unless kid is specified)
      name: name
    - description: Secret UUID (optional, unless name is unspecified)
      name: kid
    description: Get the secret metadata without exposing its value
    name: fortanix-get-secret-metadata
    outputs:
    - contextPath: Fortanix.Secret
      description: Secret metadata, if successful
  - arguments:
    - description: Secret UUID (mandatory)
      name: kid
      required: true
    description: Retrieve the secret value
    name: fortanix-fetch-secret
    outputs:
    - contextPath: Fortanix.Secret.Value
      description: Sensitive value of the secret
  - arguments:
    - description: Name of the secret (mandatory)
      name: name
    - description: Sensitive value of the secret (mandatory)
      name: value
      required: true
    - description: Group UUID to import the secret into (optional)
      name: group_id
    - description: List of key-value pairs (optional)
      name: metadata
      type: keyValue
    description: Import a new secret
    name: fortanix-new-secret
    outputs:
    - contextPath: Fortanix.Secret
      description: Secret metadata, if successful
  - arguments:
    - description: Name of the secret (mandatory)
      name: name
      required: true
    - description: Sensitive value of the secret (mandatory)
      name: value
      required: true
    - description: List of key-value pairs (optional)
      name: metadata
      type: keyValue
    description: Update an existing secret, which will be rotated
    name: fortanix-rotate-secret
    outputs:
    - contextPath: Fortanix.Secret
      description: Secret metadata, if successful
  - arguments:
    - description: Secret UUID (mandatory)
      name: kid
    description: Delete the secret
    name: fortanix-delete-secret
    outputs:
    - contextPath: Fortanix.Secret.Result
      description: Deletion status
  - arguments:
    - description: Plugin UUID (mandatory)
      name: pid
      required: true
    - description: Arbitrary user input based on the plugin (optional)
      name: input
      type: keyValue
    description: Invoke a Fortanix Plugin that is executed in a Confidential Computing enclave
    name: fortanix-invoke-plugin
    outputs:
    - contextPath: Fortanix.Plugin.Output
      description: Plugin invocation output
  - arguments:
    - description: User data (mandatory)
      name: data
      required: true
    - description: Key name used for protection (optional, overrides configured)
      name: key
    - auto: PREDEFINED
      description: Encryption mode (optional, overrides configured))
      name: mode
      predefined:
      - FPE
      - GCM
      - CBC
    description: Protects data using key configured in Fortanix DSM
    name: fortanix-encrypt
    outputs:
    - contextPath: Fortanix.Data.Cipher
      description: Encryption output
  - arguments:
    - description: Protected ciphertext (mandatory)
      name: cipher
      required: true
    - description: Key UUID for decryption (optional, overrides configured)
      name: kid
    - auto: PREDEFINED
      description: Decryption mode (optional, overrides configured))
      name: mode
      predefined:
      - FPE
      - GCM
      - CBC
    - description: Nonce or initialization vector (if any)
      name: iv
    description: Reveal data using key configured in Fortanix DSM
    name: fortanix-decrypt
    outputs:
    - contextPath: Fortanix.Data.Plain
      description: Decryption output
  dockerimage: demisto/python3:3.10.8.36650
  runonce: true
  script: ''
  subtype: python3
  type: python
fromversion: 6.0.0
tests:
- No tests (auto formatted)
